---
trigger: always_on
---

- このアプリの要件定義は以下の通り。要件は、ユーザーに確認の上で随時修正すること。
- 必ず日本語で回答してください。思考は英語で構いませんが、ユーザーに見せる内容は日本語で。
- implementation planも日本語で作成してください。



# 分譲マンション管理会社向け AIエージェント 要件定義書

## プロジェクト概要

### プロジェクト名
**マンション管理AIアシスタント「シメスくん(SHIMESUKUN)」**

### 目的
分譲マンション管理会社の業務効率化を実現し、PCスキルに不安のある担当者でも直感的に操作できる、業務フローに自然に溶け込むAIアシスタントを提供する。

### ターゲットユーザー
- マンション管理会社のフロント担当者（物件担当者）
- 管理組合の理事・理事長
- カスタマーサポート担当者
- 経理・事務担当者

**ユーザー特性：**
- PCスキルが限定的な場合がある（50代以上の担当者が多い）
- 複数物件を同時に担当し、常に時間に追われている
- 住民対応、理事会運営、修繕対応など多岐にわたる業務を処理
- モバイルでの対応も多い（現場からの連絡、外出先での確認）

---

## コア設計思想（Harveyの指針を応用）

### 1. プロンプトを"溶かす"UX
✅ **ユーザーはプロンプトを意識せず、業務を進めるだけでAIが支援する**
- プロンプト保存機能：よく使う業務パターンをワンクリックで再利用
- 自動プロンプト改善：曖昧な指示でも正確に理解
- テンプレート化：「議事録作成」「回覧文作成」など定型業務をGUI化

### 2. 根拠の見える化
✅ **AIの回答には必ず参照元を表示し、クリックで詳細を確認できる**
- 管理規約、重要事項説明書、過去の議事録などから引用
- 引用箇所をハイライト表示
- 引用元のファイル(PDF,Wordなど)はインライン表示し、引用箇所はハイライト表示する
- 出力データには常に引用元を付与

### 3. Stay in Flow（業務に溶け込む）
✅ **既存の業務ツールやフローを変えずに、AIが自然に入り込む**
- メール連携（Outlook、Gmail Add-in）
- Excel/スプレッドシート形式でのエクスポート
- 既存の管理システム（基幹システム）との連携を想定
- モバイルファーストUI（スマホ・タブレット対応）

### 4. PCが苦手な人でも直感的に操作できる
✅ **文字入力を最小化し、選択・クリック中心のインターフェース**
- 大きなボタン、わかりやすいアイコン
- 音声入力対応
- ガイドメッセージの充実
- エラーに寛容な設計（やり直しやすい）

---

## 機能要件

### 1. ダッシュボード

#### 1.1 ホーム画面
- **物件一覧表示**
  - 担当物件のカード形式表示
  - 未対応タスク件数のバッジ表示
  - 緊急度に応じた色分け（赤：緊急、黄：要対応、緑：正常）
  
- **今日のタスク**
  - AIが自動抽出した「今日やるべきこと」
  - 理事会日程、点検予定、住民からの問い合わせ期限など
  
- **クイックアクション（大きなボタン）**
  - 「住民から問い合わせを受けた」
  - 「議事録を作る」
  - 「回覧文を作成する」
  - 「修繕業者に見積依頼」
  - 「月次報告書を作成」

#### 1.2 物件詳細画面
- 物件基本情報（住所、戸数、築年数、理事会構成など）
- 最近のアクティビティ（タイムライン表示）
- 関連ドキュメントへの素早いアクセス

---

### 2. AIチャット機能（メインインターフェース）

#### 2.1 基本機能
- **自然言語での質問・依頼**
  - 例：「ペット飼育のルールを教えて」
  - 例：「先月の理事会議事録を要約して」
  - 例：「駐輪場の不正利用についての注意文を作って」
  - ただし、具体的なマンション名は自然言語ではなくて選択式にする

- **プロンプト保存機能（"よく使う業務"）**
  - 「議事録作成」「回覧文作成」「督促文作成」などをライブラリ化
  - チームで共有可能
  - カスタマイズ可能

- **プロンプト改善機能**
  - ユーザーが雑に入力しても、AIが意図を汲み取って補正

- **コンテキスト自動取得**
  - 物件を選択済みの場合、その物件情報を自動的に参照
  - 必要な情報が不足している場合、「〇〇を選択してください」と促す

#### 2.2 マルチモーダル対応
- **音声入力**
  - スマホから音声で指示（現場作業中でも使える）
  - 「今、〇〇号室の水漏れ対応中。この内容を記録して」

- **画像アップロード**
  - 「この破損箇所の修繕見積を業者に依頼する文章を作って」
  - 現場写真から自動的に状況を把握

#### 2.3 引用・根拠の表示
- **回答に必ず参照元を表示**
  - 管理規約の第〇条、過去の議事録（〇年〇月）など
  - クリックすると該当箇所がハイライトされたPDFや文書が開く
  
- **エクスポート時に引用も付与**
  - Word、PDFに出力する際も、「この内容は〇〇を参照」と記載

---

### 3. ドキュメント編集機能（Draft Editor）

#### 3.1 共同編集UI
- **AIと人間が同じ履歴を共有**
  - AIが提案した文章は青字で表示
  - ユーザーが直接編集した部分も履歴として保存
  - バージョン管理機能（過去の版に戻せる）

- **リアルタイム修正提案**
  - 「もっと丁寧な表現にして」
  - 「簡潔にして」
  - 「敬語を減らして親しみやすく」
  - などの指示で即座に書き直し

#### 3.2 テンプレート
- **定型文書のテンプレート**
  - 理事会議事録
  - 総会議事録
  - 回覧文（工事のお知らせ、注意喚起など）
  - 督促文（管理費滞納）
  - 見積依頼書
  - 月次報告書

- **物件ごとのカスタマイズ**
  - 物件名、理事会構成、特有のルールを自動挿入

---

### 4. スプレッドシート機能（Review Table）

#### 4.1 長文の自動分解・表化
- **管理規約や重要事項説明書を表形式に変換**
  - 条項ごとに一覧表示
  - 各セルで編集・コメント・担当者アサイン可能
  
- **住民からの問い合わせ一覧**
  - 日付、号室、内容、対応状況、担当者を一覧化
  - ステータス管理（未対応/対応中/完了）
  
- **修繕履歴の一覧化**
  - 過去の修繕内容をスプレッドシート形式で表示
  - フィルタ・ソート・検索が可能

#### 4.2 自然言語での表操作
- 「対応が遅れている問い合わせを抽出して」
- 「先月の修繕費用の合計を教えて」
- 「〇〇号室の過去の問い合わせ履歴を見せて」

#### 4.3 タスク管理
- 割り当て済み/未済、完了/未完了のステータスパネル
- チーム全員で進捗を可視化

---

### 5. ワークフロー・ビルダー

#### 5.1 業務フローの自動化
- **自然言語でワークフロー作成**
  - 例：「住民から苦情を受けたときの対応フローを作って」
  - → ①記録 → ②関係者に確認 → ③回答案作成 → ④理事長承認 → ⑤住民に返信

- **GUI編集**
  - フローチャート形式で視覚的に編集
  - 条件分岐も設定可能

- **Playbookとして再利用**
  - 「騒音苦情対応フロー」「ペット違反対応フロー」などを組織で共有

---

### 6. 統合機能（Stay in Flow）

#### 6.1 メール連携
- **Outlook / Gmail Add-in**
  - 受信メールの要約
  - 返信文の自動生成
  - メール内容を自動的に記録（問い合わせ履歴として保存）

#### 6.2 既存システム連携
- **基幹システム（管理システム）との連携**
  - 住民情報、入金状況、契約情報などをインポート
  - 双方向連携で、AIで作成した文書を基幹システムに保存

#### 6.3 Excel / Google スプレッドシート連携
- **データエクスポート**
  - 問い合わせ一覧、修繕履歴、議事録などをExcel形式でエクスポート
  - 引用元も含めて出力（監査対応）

#### 6.4 モバイルアプリ
- **スマホ・タブレット対応**
  - 現場から写真アップロード＆音声入力
  - 通知機能（緊急タスク、期限切れアラート）

---

## 非機能要件

### 1. ユーザビリティ
- **大きなフォント、明確なコントラスト**（視認性重視）
- **タッチ操作に最適化**（ボタンサイズ：最低44×44px）
- **エラーメッセージは平易な日本語**
  - ❌「処理に失敗しました（エラーコード：500）」
  - ✅「接続できませんでした。もう一度お試しください」

- **ガイド機能**
  - 初回利用時のチュートリアル
  - 各画面にヘルプボタン
  - 動画マニュアルへのリンク

### 2. セキュリティ・プライバシー
- **個人情報保護**
  - 住民の個人情報は暗号化
  - アクセス権限の細かい設定（物件ごと、機能ごと）
  
- **監査証跡**
  - すべての操作ログを記録
  - 誰が・いつ・何をしたかを追跡可能

### 3. パフォーマンス
- **高速レスポンス**
  - チャット応答：3秒以内
  - ドキュメント生成：5秒以内
  
- **オフライン対応**
  - 一部機能はオフラインでも利用可能（下書き保存など）

### 4. 拡張性
- **API提供**
  - 他社システムとの連携を想定
  
- **カスタマイズ可能**
  - 企業ごとに独自テンプレートやワークフローを追加

## 技術スタック（推奨）

### フロントエンド
- **フレームワーク**: Next.js 16（App Router）
- **UI**: React 19、Tailwind CSS、shadcn/ui
- **状態管理**: SWR
- **モバイル対応**: レスポンシブデザイン、PWA化

### バックエンド
- **API**: Next.js API Routes / Server Actions
- **データベース**: Supabase（PostgreSQL + Supabase Auth + RLS）
- **ファイルストレージ**: Vercel Blob
- **AI**: Vercel AI SDK（OpenAI / Anthropic / Gemini）

### インフラ
- **ホスティング**: Vercel
- **認証**: Supabase Auth
- **メール連携**: Microsoft Graph API（Outlook）、Gmail API

---

## 開発フェーズ

### Phase 1: MVP（最小限の機能）
- ダッシュボード（物件一覧、今日のタスク）
- AIチャット（基本的な質問応答）
- ドキュメント編集（議事録、回覧文）
- 引用表示機能

### Phase 2: 拡張機能
- スプレッドシート機能（問い合わせ一覧、修繕履歴）
- プロンプト保存・Playbook機能
- 音声入力・画像アップロード

### Phase 3: 統合・連携
- メール連携（Outlook / Gmail Add-in）
- 既存基幹システム連携
- モバイルアプリ（iOS / Android）

---

## KPI（成功指標）

### 業務効率化
- 議事録作成時間：従来比 **70%削減**
- 回覧文作成時間：従来比 **80%削減**
- 問い合わせ対応時間：従来比 **50%削減**

### ユーザー満足度
- システム利用率：担当者の **90%以上**が週次利用
- NPS（Net Promoter Score）：**50以上**
- サポート問い合わせ件数：月次 **10件以下**

### エラー率
- AIの誤回答率：**5%以下**
- システムダウン時間：**月次1時間以内**

---

## まとめ

本要件定義書は、Harveyの設計思想を分譲マンション管理業務に応用し、「プロンプトを溶かすUX」「根拠の見える化」「Stay in Flow」「直感的操作」を実現することを目指しています。

PCスキルに不安のある担当者でも、業務フローを変えずに自然にAIを活用できる、次世代の管理業務支援システムの実現を目指します。